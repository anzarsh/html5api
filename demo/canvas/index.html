<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>HTML5 API. Демонстрация: сanvas</title>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    
    canvas {
      display: block;
      margin: 20px auto 0;
      border: 1px dotted purple;
    }
  </style>
</head>

<body>
  <canvas id="c" width="500" height="500"></canvas>
</body>
<script>
  var canvas = document.getElementById("c");
  var ctx = canvas.getContext("2d");

  var W = 150,
      H = 75,
      w = W/ -2,
      h = H/ -2;
  ctx.save();

  ctx.translate(250, 150);
  ctx.save();

  ctx.rotate(Math.PI/4);
  ctx.save();

  ctx.scale(2, 2);
  ctx.fillRect(w, h, W, H);

  ctx.restore();
  ctx.fillStyle = "yellow";
  ctx.fillRect(w, h, W, H);

  ctx.restore();
  ctx.fillStyle = "red";
  ctx.fillRect(w, h, W, H);

  ctx.restore();
  ctx.fillStyle = "green";
  ctx.fillRect(w, h, W, H);

  /*
//  ctx.fillRect(10, 10, 100, 50);
//  ctx.translate(250, 150);
  ctx.fillStyle = "yellow";
  //  ctx.scale(1, 0.5);
//  ctx.rotate(Math.PI / 4);
//  ctx.translate(50, 0);
  ctx.fillRect(0, 0, 250, 100);
  //  ctx.transform(1, 1, 0, 1, 0, 0);
  ctx.setTransform(1 , 0.5, -0.5, 1, 0, 0);
  ctx.fillStyle = "red";
  ctx.fillRect(0, 0, 250, 100);
  console.log(Math.sin(Math.PI/4));

*/






  /*var x = 250,
      y = 140,
      txt = "Hello, world!";
  ctx.font = "30pt Calibri";
  ctx.textAlign = "center";
  ctx.fillStyle = "red";
  ctx.fillText(txt, x, y);
  var m = ctx.measureText(txt);
  console.log(m);
  ctx.beginPath();
  ctx.moveTo(x - (m.width/2), y);
  ctx.lineTo(x + (m.width/2), y);
//  ctx.lineWidth = 15;
//  ctx.strokeStyle = "black";
  ctx.stroke();*/


  /*ctx.strokeStyle = "red";
  ctx.moveTo(5, 100);
  ctx.lineTo(400, 100);
  ctx.stroke();
  ctx.font = "20pt Arial";
//  ctx.fillStyle = "red";
  str = "Hhello hello hello hello hellohellohello hello hello hello hello";
//  ctx.textAlign = "start";
  ctx.textBaseline = "alphabetic";
  ctx.fillText(str, 5, 100);
//  ctx.textAlign = "end";
//  ctx.fillText(str, 150, 80);
//  ctx.textAlign = "left";
//  ctx.fillText(str, 150, 100);
//  ctx.textAlign = "center";
//  ctx.fillText(str, 150, 120);
//  ctx.textAlign = "right";
//  ctx.fillText(str, 150, 140);
//  ctx.strokeStyle = "blue";
//  ctx.strokeText("Hello", 10, 200);
  //  ctx.fill();
*/

  /*var img = new Image();
  img.src = "imgs/pattern.gif";
  img.onload = function(){
      var p = ctx.createPattern(this, "no-repeat");
      ctx.rect(0,0,500,500);
      ctx.fillStyle = p;
      ctx.fill();
  };*/




  /*ctx.rect(0, 0, 500, 500);
  var grd = ctx.createRadialGradient(138, 50, 10, 238, 250, 300);
  grd.addColorStop(0, "red");
  grd.addColorStop(1, "silver");

  ctx.fillStyle = grd;
  ctx.fill();*/


  /*ctx.beginPath();
  ctx.rect(188, 50, 200, 100);
  ctx.rect(188, 100, 300, 150);
  ctx.fillStyle = "rgba(0,0,0,.2)";
  ctx.fill();
  ctx.lineWidth = 5;
  ctx.stroke();*/

  /*ctx.fillStyle = "rgba(0,0,0,.2)";
  ctx.fillRect(188, 50, 200, 100);*/


  /*ctx.beginPath();
  ctx.moveTo(99, 150);
  ctx.lineTo(149, 50);
  ctx.lineTo(199, 150);
  ctx.lineJoin = "bevel";

  ctx.lineWidth = 15;
  ctx.stroke();*/


/*function bezierRound(radius, points, center, bezierRadius, color){
  ctx.beginPath();
  ctx.strokeStyle = color;
  var prevX = center.x;
  var prevY = center.y + radius;
  var endRand1 = (bezierRadius*(Math.random() * 2 - 1))
  var endRand2 = (bezierRadius*(Math.random() * 2 - 1))
  var point1X = prevX + endRand1;
  var point1Y = prevY + endRand2;
  ctx.moveTo(prevX, prevY);
  for (var i = 1; i <= points; i++){
    var x = center.x + Math.sin((i/points) * (2*Math.PI)) * radius;
    var y = center.y + Math.cos((i/points) * (2*Math.PI)) * radius;

    // ctx.lineTo(x, y);

    var rand1 = (bezierRadius*(Math.random() * 2 - 1));
    var rand2 = (bezierRadius*(Math.random() * 2 - 1));
    var point2X = x + rand1
    var point2Y = y + rand2;

    ctx.bezierCurveTo(point1X, point1Y, point2X, point2Y, x, y);

    
    prevX = x;
    prevY = y;
    point1X = prevX - rand1;
    point1Y = prevY - rand2;
  }
  ctx.lineWidth = 1;
  ctx.stroke();
}

function bezierTube(){
  var radius = 90;
  var points = 180;
  var center = {
    x: 300,
    y: 300
  }

  var bezierRadius = 10;

  var red = 0;
  var green = 0;
  var blue = 0;

  for (var i = 5; i < 35; i++){
    center.x /= 1.01;
    center.y /= 1.02;

    red = -Math.pow((i-10)/12, 2) + 1;
    red = red>=0?red*255:0;
    green = -Math.pow((i-20)/12, 2) + 1;
    green = green>=0?green*255:0;
    blue = -Math.pow((i-30)/12, 2) + 1;
    blue = blue>=0?blue*255:0;
    var rgb = "rgb("+red+","+green+","+blue+")";
    bezierRound(radius+(i*1), points, center, bezierRadius, rgb);
  }
}


bezierTube();*/


// var interval = setInterval(function(){
//   ctx.clearRect(0, 0, canvas.width, canvas.height);
//   bezierTube();
// }, 60);

// setTimeout(function(){
//   clearInterval(interval);
// }, 2000)

  //  ctx.bezierCurveTo(140, 10, 338, 10, 388, 170);

  /*ctx.beginPath();
  ctx.moveTo(188, 150);
  ctx.quadraticCurveTo(288, 0, 388, 150);
  ctx.lineWidth = 5;
  ctx.stroke();*/

  /*var x = canvas.width/2,
      y = canvas.height/2,
      r = 150,
      a1 = 1.0 * Math.PI,
      a2 = 2.0 * Math.PI,
      c = false;
  ctx.beginPath();
  ctx.arc(x, y, r, a1, a2, c);
  ctx.lineWidth = 5;
  ctx.stroke();*/

  /*ctx.beginPath();
  ctx.moveTo(100, 50);
  ctx.lineTo(450, 50);
  ctx.moveTo(100, 150);
  ctx.lineTo(450, 100);
  ctx.lineWidth = 15;
  ctx.strokeStyle = "#f00";
  ctx.lineCap = "square";
  ctx.stroke();*/
</script>

</html>